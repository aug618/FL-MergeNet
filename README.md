# è”é‚¦å­¦ä¹  + MergeNet Alphaå¯¹æ¯”å®éªŒæŒ‡å—

## ğŸ¯ å®éªŒç›®æ ‡

æœ¬å®éªŒä½“ç³»ä¸“æ³¨äºéªŒè¯**ä¸åŒæ•°æ®å¼‚æ„ç¨‹åº¦**ä¸‹è”é‚¦å­¦ä¹ ä¸MergeNetçŸ¥è¯†èåˆæŠ€æœ¯çš„ç»“åˆæ•ˆæœï¼Œé€šè¿‡Alphaå¯¹æ¯”å®éªŒéªŒè¯ï¼š

1. **MergeNetçŸ¥è¯†èåˆåœ¨ä¸åŒæ•°æ®å¼‚æ„æ€§ä¸‹çš„æœ‰æ•ˆæ€§**
2. **è”é‚¦å­¦ä¹ åœ¨ä¸åŒæ•°æ®åˆ†å¸ƒä¸‹çš„æ€§èƒ½è¡¨ç°**  
3. **å›ºå®šResNet vs å¯è®­ç»ƒResNetåœ¨å¼‚æ„ç¯å¢ƒä¸‹çš„å·®å¼‚**
4. **æ•°æ®å¼‚æ„ç¨‹åº¦å¯¹çŸ¥è¯†èåˆæ•ˆæœçš„å½±å“**

## ğŸ“Š å®éªŒè®¾è®¡

### Alphaå¯¹æ¯”å®éªŒæ¦‚è§ˆ

| å®éªŒç±»å‹ | è„šæœ¬æ–‡ä»¶ | Alphaå€¼ | æ•°æ®å¼‚æ„æ€§ | çŸ¥è¯†èåˆ |
|---------|---------|---------|-----------|---------|
| **çº¯è”é‚¦å­¦ä¹ ** | `pure_federated_learning.py` | 0.5, 10, 100 | é«˜â†’ä½ | æ—  |
| **å›ºå®šResNet MergeNet** | `federated_mergenet_fixed.py` | 0.5, 10, 100 | é«˜â†’ä½ | å›ºå®šteacher |
| **å¯è®­ç»ƒResNet MergeNet** | `federated_mergenet_trainable.py` | 0.5, 10, 100 | é«˜â†’ä½ | å¯è®­ç»ƒteacher |

### Alphaå€¼å«ä¹‰

- **Alpha = 0.5**: é«˜æ•°æ®å¼‚æ„æ€§ï¼ˆNon-IIDä¸¥é‡ï¼‰
- **Alpha = 10**: ä¸­ç­‰æ•°æ®å¼‚æ„æ€§ï¼ˆé€‚ä¸­Non-IIDï¼‰
- **Alpha = 100**: ä½æ•°æ®å¼‚æ„æ€§ï¼ˆæ¥è¿‘IIDï¼‰

### å¯¹æ¯”é€»è¾‘

```
çº¯è”é‚¦ â†â†’ å›ºå®šMergeNet â†â†’ å¯è®­ç»ƒMergeNet  â†’ ä¸‰ç§æ–¹æ³•åœ¨ä¸åŒå¼‚æ„ç¨‹åº¦ä¸‹çš„å¯¹æ¯”
Alpha=0.5 â†â†’ Alpha=10 â†â†’ Alpha=100      â†’ æ•°æ®å¼‚æ„ç¨‹åº¦å¯¹æ€§èƒ½çš„å½±å“
```

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯ç»†èŠ‚

### 1. æ•°æ®åˆ’åˆ†ç­–ç•¥

- **è”é‚¦æ•°æ®åˆ’åˆ†**: ä½¿ç”¨Dirichletåˆ†å¸ƒåˆ›å»ºNon-IIDæ•°æ®åˆ†å¸ƒ
- **Alphaå‚æ•°æ§åˆ¶**: 
  - Î±=0.5: é«˜å¼‚æ„æ€§ï¼Œå®¢æˆ·ç«¯æ•°æ®åˆ†å¸ƒå·®å¼‚å¾ˆå¤§
  - Î±=10: ä¸­å¼‚æ„æ€§ï¼Œå®¢æˆ·ç«¯æ•°æ®åˆ†å¸ƒæœ‰ä¸€å®šå·®å¼‚
  - Î±=100: ä½å¼‚æ„æ€§ï¼Œå®¢æˆ·ç«¯æ•°æ®åˆ†å¸ƒæ¥è¿‘å‡åŒ€
- **50ä¸ªå®¢æˆ·ç«¯**: æ¯ä¸ªå®¢æˆ·ç«¯è‡³å°‘50ä¸ªæ ·æœ¬
- **æ ‡ç­¾å¼‚æ„**: ä¸åŒå®¢æˆ·ç«¯å…·æœ‰ä¸åŒçš„ç±»åˆ«åˆ†å¸ƒåå¥½
- **æ— æ•°æ®é‡å **: ç¡®ä¿å®¢æˆ·ç«¯é—´æ•°æ®å®Œå…¨åˆ†ç¦»

### 2. è”é‚¦å­¦ä¹ é…ç½®

- **æ€»å®¢æˆ·ç«¯æ•°**: 50ä¸ª
- **æ¯è½®é€‰æ‹©**: 15ä¸ªå®¢æˆ·ç«¯å‚ä¸è®­ç»ƒ
- **è”é‚¦å¹³å‡é¢‘ç‡**: æ¯2ä¸ªbatchè¿›è¡Œä¸€æ¬¡èšåˆ
- **æœ¬åœ°è®­ç»ƒ**: æ¯ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®å­é›†

### 3. MergeNetçŸ¥è¯†èåˆ

- **å›ºå®šResNetç‰ˆæœ¬**: ä½¿ç”¨é¢„è®­ç»ƒResNet50å‚æ•°ä½œä¸ºå›ºå®šteacher
- **å¯è®­ç»ƒResNetç‰ˆæœ¬**: ResNet50ä¸å®¢æˆ·ç«¯åŒæ—¶è®­ç»ƒ
- **èåˆæœºåˆ¶**: å‚æ•°æ³¨æ„åŠ›æ¨¡å—
- **èåˆé¢‘ç‡**: è”é‚¦å¹³å‡åç«‹å³è¿›è¡ŒçŸ¥è¯†èåˆ

### 4. è®­ç»ƒå‚æ•°ç»Ÿä¸€

```python
# æ‰€æœ‰å®éªŒç»Ÿä¸€å‚æ•°
EPOCH_NUM = 200
learning_rate = 0.1
momentum = 0.9
weight_decay = 5e-4
lr_milestones = [60, 120, 160]
lr_gamma = 0.2
batch_size = 128
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…ä¾èµ–
pip install torch torchvision numpy matplotlib tqdm pyyaml swanlab

# åˆ›å»ºç›®å½•
mkdir -p logs checkpoints results

# ç¯å¢ƒæ£€æŸ¥
python validate_alpha_experiments.py
```

### 2. è¿è¡ŒAlphaå¯¹æ¯”å®éªŒ

#### å®Œæ•´å¯¹æ¯”å®éªŒï¼ˆæ¨èæŒ‰é¡ºåºè¿è¡Œï¼‰
```bash
# çº¯è”é‚¦å­¦ä¹ å®éªŒ - Alpha: 0.5, 10, 100
python pure_federated_learning.py

# å›ºå®šResNet MergeNetå®éªŒ - Alpha: 0.5, 10, 100  
python federated_mergenet_fixed.py

# å¯è®­ç»ƒResNet MergeNetå®éªŒ - Alpha: 0.5, 10, 100
python federated_mergenet_trainable.py
```

#### å•ç‹¬è¿è¡ŒåŸºçº¿å®éªŒ
```bash
# åŸºçº¿å®éªŒ - å•MobileNetV2
python run_alone.py

# æ ‡å‡†MergeNetå®éªŒ - çŸ¥è¯†èåˆ
python run_res50_mbv2.py
```

### 3. éªŒè¯å’Œæ£€æŸ¥

```bash
# éªŒè¯Alphaå®éªŒé…ç½®
python validate_alpha_experiments.py

# éªŒè¯è”é‚¦å­¦ä¹ æ•°æ®åˆ’åˆ†ä¸€è‡´æ€§
python verify_federated_consistency.py

# ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥
python check_experiment_system.py
```

## ğŸ“ˆ å®éªŒç›‘æ§

### SwanLabç›‘æ§

æ‰€æœ‰Alphaå¯¹æ¯”å®éªŒéƒ½é›†æˆäº†SwanLabå®æ—¶ç›‘æ§ï¼š

- **Pure-Federated-Alpha-Comparison**: çº¯è”é‚¦å­¦ä¹ ä¸åŒAlphaå€¼å¯¹æ¯”
- **Fixed-MergeNet-Alpha-Comparison**: å›ºå®šResNet MergeNetä¸åŒAlphaå€¼å¯¹æ¯”  
- **Trainable-MergeNet-Alpha-Comparison**: å¯è®­ç»ƒResNet MergeNetä¸åŒAlphaå€¼å¯¹æ¯”

#### ç›‘æ§æŒ‡æ ‡
- **è®­ç»ƒæŒ‡æ ‡**: loss, accuracy, learning_rate, selected_clients
- **æµ‹è¯•æŒ‡æ ‡**: test_loss, test_accuracy (top1/top5)
- **è”é‚¦æŒ‡æ ‡**: federated_rounds, client_selection, data_heterogeneity
- **çŸ¥è¯†èåˆ**: fusion_applied, parameter_changes (MergeNetå®éªŒ)

### æ—¥å¿—æ–‡ä»¶

```
logs/
â”œâ”€â”€ pure_federated_50clients.log                    # çº¯è”é‚¦å­¦ä¹ æ—¥å¿—
â”œâ”€â”€ federated_mergenet_fixed.log                    # å›ºå®šResNet MergeNetæ—¥å¿—
â”œâ”€â”€ federated_mergenet_trainable.log                # å¯è®­ç»ƒResNet MergeNetæ—¥å¿—
â”œâ”€â”€ baseline_mobilenetv2.log                        # åŸºçº¿å®éªŒæ—¥å¿—
â””â”€â”€ train_res50_mbv2.log                            # æ ‡å‡†MergeNetæ—¥å¿—
```

### æ¨¡å‹ä¿å­˜

```
checkpoints/
â”œâ”€â”€ pure_federated_best_client_*.pth                # çº¯è”é‚¦å®¢æˆ·ç«¯æ¨¡å‹
â”œâ”€â”€ fixed_mergenet_best_client_*.pth                # å›ºå®šMergeNetå®¢æˆ·ç«¯æ¨¡å‹  
â”œâ”€â”€ trainable_mergenet_best_client_*.pth            # å¯è®­ç»ƒMergeNetå®¢æˆ·ç«¯æ¨¡å‹
â”œâ”€â”€ run_alone_best_mobilenet.pth                    # åŸºçº¿æœ€ä½³æ¨¡å‹
â””â”€â”€ best_resnet50_lr_*.pth                          # MergeNet ResNet50æ¨¡å‹
```

## ğŸ“Š ç»“æœåˆ†æ

### Alphaå¯¹æ¯”åˆ†ææ–¹æ³•

#### 1. æ€§èƒ½å¯¹æ¯”çŸ©é˜µ

| æ–¹æ³• \ Alpha | 0.5 (é«˜å¼‚æ„) | 10 (ä¸­å¼‚æ„) | 100 (ä½å¼‚æ„) |
|-------------|-------------|-----------|-------------|
| çº¯è”é‚¦å­¦ä¹  | acc_0.5 | acc_10 | acc_100 |
| å›ºå®šMergeNet | acc_0.5 | acc_10 | acc_100 |
| å¯è®­ç»ƒMergeNet | acc_0.5 | acc_10 | acc_100 |

#### 2. å…³é”®åˆ†ææŒ‡æ ‡

- **å®¢æˆ·ç«¯å¹³å‡å‡†ç¡®ç‡**: æ‰€æœ‰å®¢æˆ·ç«¯çš„å¹³å‡æ€§èƒ½
- **å®¢æˆ·ç«¯æœ€ä½³å‡†ç¡®ç‡**: æœ€ä¼˜å®¢æˆ·ç«¯çš„æ€§èƒ½
- **å®¢æˆ·ç«¯æ€§èƒ½æ–¹å·®**: å®¢æˆ·ç«¯é—´æ€§èƒ½å·®å¼‚ç¨‹åº¦
- **æ”¶æ•›é€Ÿåº¦**: è¾¾åˆ°ç›®æ ‡å‡†ç¡®ç‡çš„è½®æ¬¡
- **è®­ç»ƒç¨³å®šæ€§**: æ€§èƒ½æ³¢åŠ¨ç¨‹åº¦

#### 3. æ—¥å¿—åˆ†ææ–¹æ³•

```bash
# æŸ¥çœ‹ç‰¹å®šAlphaå€¼çš„ç»“æœ
grep "Alpha = 0.5" logs/pure_federated_50clients.log
grep "Alpha = 10" logs/federated_mergenet_fixed.log  
grep "Alpha = 100" logs/federated_mergenet_trainable.log

# æå–æœ€ç»ˆå‡†ç¡®ç‡
grep "å¹³å‡æœ€ä½³å‡†ç¡®ç‡" logs/*.log

# æŸ¥çœ‹è®­ç»ƒæ—¶é—´å¯¹æ¯”
grep "æ€»è®­ç»ƒæ—¶é—´" logs/*.log
```

### é¢„æœŸå‘ç°

#### 1. Alphaå€¼å½±å“
- **Î±=0.5**: é«˜å¼‚æ„æ€§ï¼Œæ€§èƒ½è¾ƒä½ï¼ŒMergeNetæå‡æ›´æ˜æ˜¾
- **Î±=10**: ä¸­å¼‚æ„æ€§ï¼Œå¹³è¡¡çš„æ€§èƒ½è¡¨ç°
- **Î±=100**: ä½å¼‚æ„æ€§ï¼Œæ¥è¿‘IIDï¼Œæ‰€æœ‰æ–¹æ³•æ€§èƒ½æœ€å¥½

#### 2. æ–¹æ³•å¯¹æ¯”
- **çº¯è”é‚¦ < å›ºå®šMergeNet < å¯è®­ç»ƒMergeNet** (åœ¨é«˜å¼‚æ„ç¯å¢ƒ)
- **å›ºå®šMergeNet â‰ˆ å¯è®­ç»ƒMergeNet** (åœ¨ä½å¼‚æ„ç¯å¢ƒ)

#### 3. å¼‚æ„æ€§æ•æ„Ÿåº¦
- **çº¯è”é‚¦å­¦ä¹ **: å¯¹å¼‚æ„æ€§æœ€æ•æ„Ÿ
- **å›ºå®šMergeNet**: ä¸­ç­‰æ•æ„Ÿåº¦
- **å¯è®­ç»ƒMergeNet**: å¯¹å¼‚æ„æ€§æœ€é²æ£’

## ğŸ” é‡è¦å‘ç°

### Alphaå¯¹æ¯”å®éªŒçš„å…³é”®æ´å¯Ÿ

ç»è¿‡æ·±å…¥åˆ†æå’Œä¼˜åŒ–ï¼Œæˆ‘ä»¬æ„å»ºäº†å®Œæ•´çš„Alphaå¯¹æ¯”å®éªŒä½“ç³»ï¼š

1. **æ•°æ®å¼‚æ„æ€§çš„ç³»ç»Ÿæ€§å½±å“**ï¼š
   - é€šè¿‡Î±=0.5, 10, 100ä¸‰ä¸ªå€¼ç³»ç»Ÿæ€§ç ”ç©¶æ•°æ®å¼‚æ„ç¨‹åº¦
   - æ¯ä¸ªæ–¹æ³•åœ¨ç›¸åŒçš„æ•°æ®åˆ†å¸ƒä¸‹è¿›è¡Œå…¬å¹³å¯¹æ¯”

2. **MergeNetåœ¨å¼‚æ„ç¯å¢ƒä¸‹çš„é€‚åº”æ€§**ï¼š
   - å›ºå®šResNetç‰ˆæœ¬ï¼šä½¿ç”¨é¢„è®­ç»ƒå‚æ•°ï¼Œå‡å°‘èµ„æºç«äº‰
   - å¯è®­ç»ƒResNetç‰ˆæœ¬ï¼šæœåŠ¡å™¨ç«¯æŒç»­å­¦ä¹ ï¼Œé€‚åº”æ•°æ®åˆ†å¸ƒ

3. **è”é‚¦å­¦ä¹ çš„å¼‚æ„æ€§æŒ‘æˆ˜**ï¼š
   - é«˜å¼‚æ„æ€§(Î±=0.5)ä¸‹å®¢æˆ·ç«¯æ€§èƒ½å·®å¼‚æ˜¾è‘—
   - ä½å¼‚æ„æ€§(Î±=100)ä¸‹æ¥è¿‘é›†ä¸­å¼è®­ç»ƒæ•ˆæœ

### å®éªŒä¼˜åŒ–æ”¹è¿›

#### åŸå§‹ç‰ˆæœ¬é—®é¢˜
- **èµ„æºç«äº‰**: åŒæ—¶è®­ç»ƒResNet50å’Œ50ä¸ªå®¢æˆ·ç«¯æ¨¡å‹
- **è¯„ä¼°ä¸ä¸€è‡´**: ä¸åŒå®éªŒä½¿ç”¨ä¸åŒçš„è¯„ä¼°é¢‘ç‡
- **é…ç½®å·®å¼‚**: å„å®éªŒé—´å‚æ•°è®¾ç½®ä¸ç»Ÿä¸€

#### å½“å‰ç‰ˆæœ¬ä¼˜åŒ–
- **ç»Ÿä¸€é…ç½®**: æ‰€æœ‰å®éªŒä½¿ç”¨ç›¸åŒçš„åŸºç¡€å‚æ•°
- **åˆ†ç¦»å…³æ³¨ç‚¹**: å›ºå®švså¯è®­ç»ƒResNetæ¸…æ™°å¯¹æ¯”
- **ç³»ç»Ÿæ€§å¯¹æ¯”**: ä¸‰ä¸ªAlphaå€¼ Ã— ä¸‰ç§æ–¹æ³• = 9ä¸ªå®éªŒç‚¹
- **èµ„æºç®¡ç†**: åˆç†åˆ†é…GPUèµ„æºï¼Œé¿å…ç«äº‰

### å®Œæ•´å®éªŒçŸ©é˜µ

| å®éªŒç‰ˆæœ¬ | è„šæœ¬æ–‡ä»¶ | Alphaå€¼ | çŠ¶æ€ | ç‰¹ç‚¹ |
|---------|---------|---------|------|------|
| çº¯è”é‚¦å­¦ä¹  | `pure_federated_learning.py` | 0.5,10,100 | âœ… å°±ç»ª | ä»…è”é‚¦å¹³å‡ |
| å›ºå®šMergeNet | `federated_mergenet_fixed.py` | 0.5,10,100 | âœ… å°±ç»ª | é¢„è®­ç»ƒteacher |
| å¯è®­ç»ƒMergeNet | `federated_mergenet_trainable.py` | 0.5,10,100 | âœ… å°±ç»ª | åŠ¨æ€teacher |
| åŸºçº¿å¯¹æ¯” | `run_alone.py` | - | âœ… å¯ç”¨ | å•æ¨¡å‹è®­ç»ƒ |
| æ ‡å‡†MergeNet | `run_res50_mbv2.py` | - | âœ… å¯ç”¨ | é›†ä¸­å¼èåˆ |

## ğŸ” å®éªŒéªŒè¯

### Alphaé…ç½®éªŒè¯

```bash
# éªŒè¯æ‰€æœ‰æ–‡ä»¶çš„Alphaå®éªŒé…ç½®
python validate_alpha_experiments.py

# æ£€æŸ¥ç‰¹å®šæ–‡ä»¶é…ç½®
grep -n "alpha_values" *.py
grep -n "Alpha.*Comparison" *.py
```

### æ•°æ®å®Œæ•´æ€§éªŒè¯

```bash
# éªŒè¯ä¸åŒAlphaå€¼çš„æ•°æ®åˆ’åˆ†
python -c "
from dataset.federated_data_partition import create_federated_dataloaders
from dataset.cls_dataloader import train_dataloader

for alpha in [0.5, 10, 100]:
    print(f'\\n=== Alpha = {alpha} ===')
    partitioner, loaders = create_federated_dataloaders(
        train_dataloader.dataset, 50, alpha, 128, 2, 50
    )
    partitioner.print_statistics()
"
```

### åŠŸèƒ½æµ‹è¯•

```bash
# éªŒè¯è”é‚¦å­¦ä¹ ä¸€è‡´æ€§
python verify_federated_consistency.py

# ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥
python check_experiment_system.py

# å¿«é€Ÿsmoke test
python -c "
import torch
from model.MobileNet_v2 import mobilenetv2
from model.ResNet import resnet50
print('âœ… æ¨¡å‹å¯¼å…¥æ­£å¸¸')

from dataset.cls_dataloader import train_dataloader, test_dataloader
print('âœ… æ•°æ®åŠ è½½æ­£å¸¸')

print('âœ… æ‰€æœ‰ä¾èµ–å°±ç»ª')
"
```

## ğŸ“ å®éªŒè®°å½•æ¨¡æ¿

### Alphaå¯¹æ¯”å®éªŒæ—¥å¿—æ ¼å¼

```
=== Alpha = [0.5/10/100] [æ–¹æ³•åç§°] å®éªŒ ===
å¼€å§‹æ—¶é—´: [æ—¶é—´æˆ³]
æ•°æ®å¼‚æ„ç¨‹åº¦: Alpha = [å€¼]
å®¢æˆ·ç«¯é…ç½®: 50æ€»æ•°, 15é€‰æ‹©
è”é‚¦é…ç½®: æ¯2batchå¹³å‡, 200epochs
æ¨¡å‹é…ç½®: [MobileNetV2/ResNet50é…ç½®]
çŸ¥è¯†èåˆ: [æ— /å›ºå®šResNet/å¯è®­ç»ƒResNet]

è®­ç»ƒè¿‡ç¨‹:
- Epoch 0-20: [åˆæœŸè¡¨ç°]
- Epoch 50: [ä¸­æœŸè¡¨ç°]  
- Epoch 100: [åæœŸè¡¨ç°]
- æœ€ç»ˆç»“æœ: [æœ€ç»ˆå‡†ç¡®ç‡]

æœ€ç»ˆç»Ÿè®¡:
- å®¢æˆ·ç«¯å¹³å‡å‡†ç¡®ç‡: [æ•°å€¼]%
- å®¢æˆ·ç«¯æœ€ä½³å‡†ç¡®ç‡: [æ•°å€¼]%
- å®¢æˆ·ç«¯æœ€å·®å‡†ç¡®ç‡: [æ•°å€¼]%
- æ€§èƒ½æ ‡å‡†å·®: [æ•°å€¼]
- æ€»è®­ç»ƒæ—¶é—´: [æ—¶é•¿]

ç»“æŸæ—¶é—´: [æ—¶é—´æˆ³]
```

### è·¨Alphaå¯¹æ¯”åˆ†æè®°å½•

```
=== [æ–¹æ³•åç§°] è·¨Alphaå¯¹æ¯”åˆ†æ ===

æ€§èƒ½å˜åŒ–è¶‹åŠ¿:
- Alpha=0.5  â†’ Alpha=10:  æå‡ [æ•°å€¼]%
- Alpha=10   â†’ Alpha=100: æå‡ [æ•°å€¼]%
- Alpha=0.5  â†’ Alpha=100: æ€»æå‡ [æ•°å€¼]%

å¼‚æ„æ€§æ•æ„Ÿåº¦:
- é«˜å¼‚æ„(Î±=0.5): [æ€§èƒ½è¡¨ç°]
- ä¸­å¼‚æ„(Î±=10):  [æ€§èƒ½è¡¨ç°]  
- ä½å¼‚æ„(Î±=100): [æ€§èƒ½è¡¨ç°]

æ”¶æ•›åˆ†æ:
- æ”¶æ•›é€Ÿåº¦: [epochs]
- ç¨³å®šæ€§: [æ³¢åŠ¨ç¨‹åº¦]

ç»“è®º: [åˆ†ææ€»ç»“]
```

## ğŸ¯ å®éªŒç›®æ ‡ä¸å‡è®¾

### æ ¸å¿ƒç ”ç©¶é—®é¢˜

1. **æ•°æ®å¼‚æ„æ€§å¦‚ä½•å½±å“è”é‚¦å­¦ä¹ æ€§èƒ½ï¼Ÿ**
   - å‡è®¾ï¼šAlphaå€¼è¶Šå¤§(è¶Šæ¥è¿‘IID)ï¼Œæ€§èƒ½è¶Šå¥½

2. **MergeNetçŸ¥è¯†èåˆåœ¨å¼‚æ„ç¯å¢ƒä¸‹æ˜¯å¦ä¾ç„¶æœ‰æ•ˆï¼Ÿ**
   - å‡è®¾ï¼šMergeNetåœ¨å„ç§å¼‚æ„ç¨‹åº¦ä¸‹éƒ½èƒ½å¸¦æ¥æå‡

3. **å›ºå®šResNet vs å¯è®­ç»ƒResNetå“ªä¸ªæ›´é€‚åˆå¼‚æ„è”é‚¦å­¦ä¹ ï¼Ÿ**
   - å‡è®¾ï¼šå¯è®­ç»ƒResNetåœ¨é«˜å¼‚æ„ç¯å¢ƒä¸‹è¡¨ç°æ›´å¥½

4. **è”é‚¦å­¦ä¹ çš„å¼‚æ„æ€§æŒ‘æˆ˜æœ‰å¤šä¸¥é‡ï¼Ÿ**
   - å‡è®¾ï¼šé«˜å¼‚æ„æ€§ä¼šæ˜¾è‘—é™ä½è”é‚¦å­¦ä¹ æ•ˆæœ

### é¢„æœŸç»“æœå‡è®¾

#### æ€§èƒ½æ’åºé¢„æœŸ
```
ä½å¼‚æ„(Î±=100): å¯è®­ç»ƒMergeNet â‰¥ å›ºå®šMergeNet > çº¯è”é‚¦
ä¸­å¼‚æ„(Î±=10):  å¯è®­ç»ƒMergeNet > å›ºå®šMergeNet > çº¯è”é‚¦  
é«˜å¼‚æ„(Î±=0.5): å¯è®­ç»ƒMergeNet >> å›ºå®šMergeNet > çº¯è”é‚¦
```

#### å¼‚æ„æ€§æ•æ„Ÿåº¦é¢„æœŸ
- **çº¯è”é‚¦å­¦ä¹ **: å¯¹å¼‚æ„æ€§æœ€æ•æ„Ÿï¼Œæ€§èƒ½ä¸‹é™æœ€æ˜æ˜¾
- **å›ºå®šMergeNet**: ä¸­ç­‰æ•æ„Ÿåº¦ï¼Œæœ‰ä¸€å®šé²æ£’æ€§
- **å¯è®­ç»ƒMergeNet**: æœ€é²æ£’ï¼Œèƒ½é€‚åº”ä¸åŒæ•°æ®åˆ†å¸ƒ

### å¯èƒ½çš„æŒ‘æˆ˜ä¸é™åˆ¶

1. **è®¡ç®—èµ„æºæŒ‘æˆ˜**
   - 9ä¸ªå®éªŒ Ã— 200 epochs = å¤§é‡è®¡ç®—éœ€æ±‚
   - GPUå†…å­˜å’Œæ—¶é—´ç®¡ç†

2. **æ•°æ®å¼‚æ„æ€§å»ºæ¨¡**
   - Dirichletåˆ†å¸ƒçš„å±€é™æ€§
   - çœŸå®å¼‚æ„æ€§å¯èƒ½æ›´å¤æ‚

3. **çŸ¥è¯†èåˆçš„æ¶æ„å·®å¼‚**
   - MobileNetV2 â†” ResNet50è·¨æ¶æ„èåˆçš„åˆç†æ€§
   - å‚æ•°æ³¨æ„åŠ›æœºåˆ¶çš„æœ‰æ•ˆæ€§

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **CUDAå†…å­˜ä¸è¶³**
   ```bash
   # å‡å°‘batch_sizeæˆ–å®¢æˆ·ç«¯æ•°é‡
   export CUDA_VISIBLE_DEVICES=0
   ```

2. **SwanLabè¿æ¥é—®é¢˜**
   ```bash
   # æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ä½¿ç”¨ç¦»çº¿æ¨¡å¼
   export SWANLAB_MODE=offline
   ```

3. **æ•°æ®åŠ è½½é”™è¯¯**
   ```bash
   # é‡æ–°ä¸‹è½½CIFAR-100æ•°æ®
   rm -rf data/cifar-100-python*
   ```

3. **ä¾èµ–åŒ…é—®é¢˜**
   ```bash
   # é‡æ–°å®‰è£…åŸºç¡€ä¾èµ–
   pip install torch torchvision numpy matplotlib tqdm pyyaml swanlab
   ```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
export PYTHONPATH=/home/vit/milkDragon:$PYTHONPATH
python -v [å®éªŒè„šæœ¬]

# å•æ­¥è°ƒè¯•
python -m pdb [å®éªŒè„šæœ¬]
```

## ğŸ“„ å¼•ç”¨å’Œå‚è€ƒ

### ç›¸å…³è®ºæ–‡

1. MergeNetçŸ¥è¯†èåˆæŠ€æœ¯
2. è”é‚¦å­¦ä¹ ç®—æ³• (FedAvg)
3. å‚æ•°æ³¨æ„åŠ›æœºåˆ¶
4. Non-IIDæ•°æ®åˆ†å¸ƒå¤„ç†

### ä»£ç åº“ç»“æ„

```
milkDragon/
â”œâ”€â”€ model/                                      # æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ MobileNet_v2.py                        # MobileNetV2æ¨¡å‹
â”‚   â”œâ”€â”€ ResNet.py                              # ResNet50æ¨¡å‹
â”‚   â””â”€â”€ param_attention.py                     # å‚æ•°æ³¨æ„åŠ›æ¨¡å—(MergeNetæ ¸å¿ƒ)
â”œâ”€â”€ dataset/                                   # æ•°æ®å¤„ç†
â”‚   â”œâ”€â”€ cls_dataloader.py                      # CIFAR-100æ•°æ®åŠ è½½å™¨
â”‚   â””â”€â”€ federated_data_partition.py            # è”é‚¦æ•°æ®åˆ’åˆ†(Dirichlet)
â”œâ”€â”€ config/                                    # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ param_attention_config.yaml            # MergeNetå‚æ•°é…ç½®
â”œâ”€â”€ logs/                                      # è®­ç»ƒæ—¥å¿—
â”œâ”€â”€ checkpoints/                               # æ¨¡å‹æƒé‡
â”œâ”€â”€ utils/                                     # å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ === Alphaå¯¹æ¯”å®éªŒæ ¸å¿ƒæ–‡ä»¶ ===
â”œâ”€â”€ pure_federated_learning.py                 # çº¯è”é‚¦å­¦ä¹ (Alpha: 0.5,10,100)
â”œâ”€â”€ federated_mergenet_fixed.py                # å›ºå®šResNet MergeNet(Alpha: 0.5,10,100)
â”œâ”€â”€ federated_mergenet_trainable.py            # å¯è®­ç»ƒResNet MergeNet(Alpha: 0.5,10,100)
â”‚
â”œâ”€â”€ === åŸºçº¿å¯¹æ¯”å®éªŒ ===
â”œâ”€â”€ run_alone.py                               # å•MobileNetV2åŸºçº¿
â”œâ”€â”€ run_res50_mbv2.py                          # æ ‡å‡†MergeNetå®éªŒ
â”‚
â”œâ”€â”€ === éªŒè¯å’Œå·¥å…· ===
â”œâ”€â”€ validate_alpha_experiments.py              # Alphaå®éªŒé…ç½®éªŒè¯
â”œâ”€â”€ verify_federated_consistency.py            # è”é‚¦å­¦ä¹ ä¸€è‡´æ€§éªŒè¯
â”œâ”€â”€ check_experiment_system.py                 # ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥
â”‚
â””â”€â”€ README.md                                  # æœ¬æ–‡ä»¶
```

### å…³é”®æ–‡ä»¶è¯´æ˜

#### æ ¸å¿ƒå®éªŒæ–‡ä»¶
- **pure_federated_learning.py**: çº¯è”é‚¦å­¦ä¹ åŸºçº¿ï¼Œæ— çŸ¥è¯†èåˆ
- **federated_mergenet_fixed.py**: ä½¿ç”¨å›ºå®šResNetå‚æ•°çš„MergeNet
- **federated_mergenet_trainable.py**: ResNetä¸å®¢æˆ·ç«¯åŒæ­¥è®­ç»ƒçš„MergeNet

#### éªŒè¯å·¥å…·
- **validate_alpha_experiments.py**: è‡ªåŠ¨æ£€æŸ¥ä¸‰ä¸ªæ–‡ä»¶çš„Alphaé…ç½®
- **verify_federated_consistency.py**: ç¡®ä¿è”é‚¦å®éªŒçš„ä¸€è‡´æ€§
- **check_experiment_system.py**: ç³»ç»Ÿä¾èµ–å’Œç¯å¢ƒæ£€æŸ¥

---

**å®éªŒä½“ç³»ç‰ˆæœ¬**: v3.0 - Alphaå¯¹æ¯”å®éªŒ  
**æœ€åæ›´æ–°**: 2025å¹´7æœˆ6æ—¥  
**ç»´æŠ¤è€…**: MilkDragonå›¢é˜Ÿ  

ğŸš€ **ç°åœ¨å¯ä»¥å¼€å§‹è¿è¡ŒAlphaå¯¹æ¯”å®éªŒäº†ï¼**

### æ¨èè¿è¡Œé¡ºåº

1. **ç¯å¢ƒéªŒè¯**: `python validate_alpha_experiments.py`
2. **çº¯è”é‚¦åŸºçº¿**: `python pure_federated_learning.py` 
3. **å›ºå®šMergeNet**: `python federated_mergenet_fixed.py`
4. **å¯è®­ç»ƒMergeNet**: `python federated_mergenet_trainable.py`

### å®éªŒç›‘æ§

- ç›‘æ§SwanLabé¢æ¿æŸ¥çœ‹å®æ—¶è®­ç»ƒè¿›åº¦
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†è®­ç»ƒä¿¡æ¯  
- æ¯ä¸ªæ–¹æ³•è¿è¡Œ3ä¸ªAlphaå€¼ï¼Œæ€»è®¡9ç»„å®éªŒ

### é¢„æœŸæ”¶è·

é€šè¿‡æœ¬å®éªŒä½“ç³»ï¼Œæ‚¨å°†æ·±å…¥ç†è§£ï¼š
- æ•°æ®å¼‚æ„æ€§å¯¹è”é‚¦å­¦ä¹ çš„å½±å“ç¨‹åº¦
- MergeNetçŸ¥è¯†èåˆåœ¨ä¸åŒå¼‚æ„ç¯å¢ƒä¸‹çš„é€‚åº”æ€§
- å›ºå®švså¯è®­ç»ƒteacheræ¨¡å‹çš„æƒè¡¡å…³ç³»
- è”é‚¦å­¦ä¹ åœ¨ç°å®å¼‚æ„åœºæ™¯ä¸‹çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ
